FROM fedora:22 AS rpm-4.12.0.1
ARG CRYSTAL_VERSION
ARG CRYSTAL_RELEASE=1
WORKDIR /opt
RUN yum install -y gcc xz rpm-devel rpm-build
RUN curl -LO https://github.com/lugia-kun/crystal-for-legacy-dist/releases/download/${CRYSTAL_VERSION}-${CRYSTAL_RELEASE}/crystal-${CRYSTAL_VERSION}-${CRYSTAL_RELEASE}.sles11.x86_64.tar.xz
RUN xz -dc crystal-${CRYSTAL_VERSION}-${CRYSTAL_RELEASE}.sles11.x86_64.tar.xz | tar -xf -
ENV PATH=/opt/crystal-${CRYSTAL_VERSION}-${CRYSTAL_RELEASE}/bin:$PATH

# ARG CRYSTAL_VERSION
# RUN curl https://dist.crystal-lang.org/rpm/setup.sh | bash
# RUN dnf install -y rpm-build rpm-devel crystal which
# RUN test $(crystal eval "puts Crystal::VERSION") == ${CRYSTAL_VERSION}
WORKDIR /work
